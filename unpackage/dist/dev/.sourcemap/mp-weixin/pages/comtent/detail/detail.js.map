{"version":3,"file":"detail.js","sources":["pages/comtent/detail/detail.uvue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tdGVudC9kZXRhaWwvZGV0YWlsLnV2dWU"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <scroll-view scroll-y class=\"detail-scroll\">\r\n\t  <!-- 返回按钮 -->\r\n\t  <view class=\"back-button\" @click=\"goBack\">\r\n\t    <text class=\"icon\">←</text>\r\n\t  </view>\r\n\t  \n      <!-- 帖子标题 -->\n      <view class=\"post-title\">{{ post.title || '无标题' }}</view>\n\n      <!-- 作者信息 -->\n      <view class=\"post-author\">\n        <image :src=\"post.avatarUrl\" mode=\"aspectFill\" class=\"avatar\" />\n        <text>{{ post.author || '匿名' }}</text>\n        <text class=\"time\">{{ post.createdAt }}</text>\n      </view>\n\n      <!-- 描述内容 -->\n      <view v-if=\"post.description\" class=\"post-desc\">{{ post.description }}</view>\n\n      <!-- 媒体展示 -->\n      <view v-if=\"post.mediaUrl\" class=\"media-container\">\n        <image v-if=\"post.type === 'image'\" :src=\"post.mediaUrl\" mode=\"widthFix\" class=\"media\" />\n        <video v-else-if=\"post.type === 'video'\" :src=\"post.mediaUrl\" controls class=\"media\"></video>\n      </view>\n\n      <!-- 评分区域 -->\n      <view class=\"rating-section\">\n        <view class=\"rating-header\">\n          <text>评分：{{ ratingData.average_rating.toFixed(1) }} ⭐</text>\n          <text>({{ ratingData.rating_count }}人评分)</text>\n        </view>\n        <view class=\"rating-distribution\">\n          <view v-for=\"star in [5,4,3,2,1]\" :key=\"star\" class=\"bar-row\">\n            <text>{{ star }}⭐</text>\n            <progress\n              :percent=\"(ratingData.rating_distribution[star] / (ratingData.rating_count || 1)) * 100\"\n              stroke-width=\"12\"\n              activeColor=\"#FFD700\"\n            />\n            <text>{{ ratingData.rating_distribution[star] }}</text>\n          </view>\n        </view>\n        <view v-if=\"ratingData.user_rating !== null\" class=\"my-rating\">\n          您的评分：{{ ratingData.user_rating }} ⭐\n        </view>\n      </view>\n\n      <!-- 发表评论区 -->\n      <view class=\"comment-input-section\">\n        <textarea\n          v-model=\"newComment.content\"\n          placeholder=\"写下你的评论...\"\n          maxlength=\"500\"\n          class=\"comment-textarea\"\n        />\n        <view class=\"rating-input\">\n          <text>打分（可选）：</text>\n          <radio-group :value=\"newComment.rating\" @change=\"onRatingChange\">\n            <label v-for=\"r in [1,2,3,4,5]\" :key=\"r\" class=\"star-radio\">\n              <radio :value=\"r.toString()\" color=\"#FFD700\" />\n              <text>{{ r }}⭐</text>\n            </label>\n          </radio-group>\n        </view>\n        <button @click=\"submitComment\" :disabled=\"submitting\" class=\"submit-btn\">\n          {{ submitting ? '提交中...' : '发表评论' }}\n        </button>\n      </view>\n\n      <!-- 评论列表 -->\n      <view class=\"comments-section\">\n        <view class=\"section-title\">评论 ({{ ratingData.comment_count }})</view>\n        <view v-for=\"comment in comments\" :key=\"comment._id\" class=\"comment-item\">\n          <view class=\"comment-header\">\n            <text class=\"comment-author\">{{ comment.author || '匿名' }}</text>\n            <text v-if=\"comment.rating\" class=\"comment-rating\">{{ comment.rating }} ⭐</text>\n            <text class=\"comment-time\">{{ comment.createdAt }}</text>\n          </view>\n          <view class=\"comment-content\">{{ comment.comment_content }}</view>\n          <view v-if=\"isMyComment(comment)\" class=\"comment-actions\">\n            <button size=\"mini\" @click=\"deleteComment(comment)\">删除</button>\n          </view>\n        </view>\n\n        <view v-if=\"loadingComments && comments.length === 0\" class=\"loading\">加载中...</view>\n        <view v-else-if=\"!hasMoreComments && comments.length > 0\" class=\"no-more\">没有更多了</view>\n        <view v-else-if=\"comments.length === 0 && !loadingComments\" class=\"empty\">暂无评论</view>\n      </view>\n    </scroll-view>\n\n    <!-- 删除确认弹窗 -->\n    <view v-if=\"showDeleteConfirm\" class=\"delete-modal\">\n      <text>确定删除这条评论？</text>\n      <button @click=\"confirmDelete\">确定</button>\n      <button @click=\"showDeleteConfirm = false\">取消</button>\n    </view>\n  </view>\n</template>\n\n<script setup lang=\"uts\">\nimport { ref } from 'vue'\nimport { onLoad } from '@dcloudio/uni-app'\n\n// 路由参数\nconst contentId = ref('')\n\n// 帖子数据\nconst post = ref({\n  title: '',\n  description: '',\n  mediaUrl: '',\n  type: 'text',\n  author: '',\n  avatarUrl: 'https://picsum.photos/100/100?random=1',\n  createdAt: '',\n  user_id: '' // 注意：这是帖子作者的 uid\n})\n\n// 评论相关\nconst comments = ref([])\nconst loadingComments = ref(false)\nconst hasMoreComments = ref(true)\nconst currentPage = ref(1)\nconst pageSize = 10\n\n// 评分数据\nconst ratingData = ref({\n  average_rating: 0,\n  rating_count: 0,\n  rating_distribution: { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 },\n  user_rating: null,\n  comment_count: 0\n})\n\n// 新评论\nconst newComment = ref({ content: '', rating: '' })\nconst submitting = ref(false)\n\n// 删除状态\nconst showDeleteConfirm = ref(false)\nconst commentToDelete = ref(null)\n\n// 当前用户 uid\nconst myUserId = ref('')\nconst userToken = ref('')\n// ===== 页面加载 =====\nonLoad(async (query) => {\n  uni.__f__('log','at pages/comtent/detail/detail.uvue:150','【Detail 页面接收到的路由参数（onLoad）】', query)\n\n  const id = query?.id?.trim()\n  if (!id || id === 'undefined' || id === 'null') {\n    uni.showToast({ title: '无效内容ID', icon: 'none' })\n    setTimeout(() => uni.navigateBack(), 1500)\n    return\n  }\n\n  contentId.value = id\n\n  // ✅ 检查登录状态\n  const token = uni.getStorageSync('uni_id_token')\r\n  userToken.value = token\n  if (!token) {\n    uni.showToast({ title: '请先登录', icon: 'none' })\n    setTimeout(() => uni.redirectTo({ url: '/pages/user/login/login' }), 1500)\n    return\n  }\n\n  // ✅ 获取当前用户 uid\r\n  const rawStorage = uni.getStorageSync('user_info')\r\n  const userInfo = rawStorage?.userInfo || rawStorage || {}\r\n  uni.__f__('log','at pages/comtent/detail/detail.uvue:173','【Detail 页面】userInfo:', userInfo)\r\n  uni.__f__('log','at pages/comtent/detail/detail.uvue:174','【Detail 页面】userInfo._id:', userInfo?._id)\n  if (userInfo?._id) {\n    myUserId.value = userInfo._id\n  } else {\n    // 如果没有 user_info，仍可继续浏览，但无法评论\n    uni.__f__('warn','at pages/comtent/detail/detail.uvue:179','未找到 userInfo._id，可能影响评论功能')\n  }\n\n  await loadPostDetail()\n  await loadRating()\n  await loadComments(true)\n})\n\n// ===== 方法 =====\n\nasync function loadPostDetail() {\n  try {\n    const res = await uniCloud.callFunction({\n      name: 'content-api',\n      data: { action: 'get', content_id: contentId.value },\n      env: 'cloud' // ✅\n    })\n    if (res.result?.code === 200) {\n      const item = res.result.data\n      post.value = {\n        title: item.title || '',\n        description: item.text_content || '',\n        mediaUrl: item.media_files?.[0]?.url || '',\n        type: item.content_type || 'text',\n        author: item.author || '匿名',\n        avatarUrl: item.avatar || 'https://picsum.photos/100/100?random=1',\n        createdAt: formatDate(item.created_at),\n        user_id: item.user_id // 帖子作者 uid\n      }\n    } else {\n      uni.showToast({ title: '内容不存在', icon: 'none' })\n      setTimeout(() => uni.navigateBack(), 1500)\n    }\n  } catch (err) {\n    uni.__f__('error','at pages/comtent/detail/detail.uvue:213','加载帖子失败', err)\n    uni.showToast({ title: '加载失败', icon: 'none' })\n  }\n}\n\nasync function loadRating() {\n  try {\n    const res = await uniCloud.callFunction({\n      name: 'comment-api',\n      data: { \r\n\t   action: 'get-content-rating',\r\n\t   contentId: contentId.value,\r\n\t   token: userToken.value\r\n\t   }\n    })\n    if (res.result?.code === 200) {\n      const data = res.result.data\r\n      \r\n            ratingData.value = {\r\n              average_rating: data.average_rating || 0,\r\n              rating_count: data.rating_count || 0,\r\n              rating_distribution: data.rating_distribution || { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 },\r\n              comment_count: data.comment_count || 0,\r\n              user_rating: data.user_rating ? data.user_rating.rating : null  // ✅ 只取 rating 字段\r\n            }\n    }\n  } catch (err) {\n    uni.__f__('error','at pages/comtent/detail/detail.uvue:240','加载评分失败', err)\n  }\n}\n\nasync function loadComments(reset = false) {\n  if (!hasMoreComments.value && !reset) return\n  if (loadingComments.value) return\n\n  loadingComments.value = true\n  if (reset) {\n    currentPage.value = 1\n    comments.value = []\n  } else {\n    currentPage.value++\n  }\n\n  try {\n    const res = await uniCloud.callFunction({\n      name: 'comment-api',\n      data: {\n        action: 'list-comments',\n        contentId: contentId.value,\n        page: currentPage.value,\n        pageSize: pageSize,\r\n\t\ttoken: userToken.value\n      }\n    })\r\n\t\r\n\t//uni.__f__('log','at pages/comtent/detail/detail.uvue:268','【loadComments 返回】:', JSON.stringify(res, null, 2))\n\n    if (res.result?.code === 200) {\n      const list = (res.result.data.comments || []).map(c => ({\n        ...c,\n        author: c.user_info?.nickname || c.user_info?.username || '匿名',\n        createdAt: formatDate(c.created_at)\n      }))\n      if (reset) {\n        comments.value = list\r\n\t\tuni.__f__('log','at pages/comtent/detail/detail.uvue:278','【赋值给 comments】:', list)\n      } else {\n        comments.value.push(...list)\n      }\n      hasMoreComments.value = res.result.data.hasMore\n    }\n  } catch (err) {\n    uni.__f__('error','at pages/comtent/detail/detail.uvue:285','加载评论失败', err)\n    uni.showToast({ title: '评论加载失败', icon: 'none' })\n  } finally {\n    loadingComments.value = false\n  }\n}\n\nasync function submitComment() {\n  // ✅ 再次检查登录（防止 token 过期）\n  const token = uni.getStorageSync('uni_id_token')\n  if (!token) {\n    uni.showToast({ title: '请先登录', icon: 'none' })\n    setTimeout(() => uni.redirectTo({ url: '/pages/user/login/login' }), 1500)\n    return\n  }\n\n  if (!newComment.value.content.trim()) {\n    uni.showToast({ title: '请输入评论内容', icon: 'none' })\n    return\n  }\n\n  submitting.value = true\n  try {\n    const rating = newComment.value.rating ? parseInt(newComment.value.rating) : null\n\n    const res = await uniCloud.callFunction({\n      name: 'comment-api',\n      data: {\n        action: 'add-comment',\n        contentId: contentId.value,\n        commentContent: newComment.value.content.trim(),\n        rating: rating,\r\n\t\ttoken: userToken.value\n      }\n    })\r\n\t\r\n\t// uni.__f__('log','at pages/comtent/detail/detail.uvue:321','【submitComment 接口返回】:', JSON.stringify(res, null, 2))\n\n    if (res.result?.code === 200) {\n      uni.showToast({ title: '评论成功', icon: 'success' })\n      newComment.value = { content: '', rating: '' }\n      await loadRating()\n      await loadComments(true)\n    } else {\n      uni.showToast({ title: res.result?.message || '评论失败', icon: 'none' })\n    }\n  } catch (err) {\n    uni.__f__('error','at pages/comtent/detail/detail.uvue:332','提交评论失败', err)\n    uni.showToast({ title: '网络错误', icon: 'none' })\n  } finally {\n    submitting.value = false\n  }\n}\nfunction goBack() {\n  uni.navigateBack()\n}\r\n\nfunction onRatingChange(e) {\n  newComment.value.rating = e.detail.value\n}\n\nfunction deleteComment(comment) {\n  commentToDelete.value = comment\n  showDeleteConfirm.value = true\n}\n\nasync function confirmDelete() {\n  const comment = commentToDelete.value\n  if (!comment) return\n\n  try {\n    const res = await uniCloud.callFunction({\n      name: 'comment-api',\n      data: { \r\n\t\taction: 'delete-comment', \r\n\t\tcommentId: comment._id,\r\n\t\ttoken: userToken.value\r\n\t\t}\n    })\n\n    if (res.result?.code === 200) {\n      uni.showToast({ title: '删除成功', icon: 'success' })\n      await loadRating()\n      await loadComments(true)\n    } else {\n      uni.showToast({ title: res.result?.message || '删除失败', icon: 'none' })\n    }\n  } catch (err) {\n    uni.__f__('error','at pages/comtent/detail/detail.uvue:373','删除失败', err)\n    uni.showToast({ title: '删除失败', icon: 'none' })\n  } finally {\n    showDeleteConfirm.value = false\n    commentToDelete.value = null\n  }\n}\n\nfunction formatDate(timestamp) {\n  if (!timestamp) return ''\n  const d = new Date(timestamp)\n  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')} ${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`\n}\n\nfunction isMyComment(comment) {\n  // 评论的 user_id 必须等于当前用户的 uid\n  return comment.user_id === myUserId.value\n}\n</script>\n\n<style scoped>\n/* 样式保持不变，此处省略以节省篇幅 */\n.container {\n  height: 100vh;\n  background-color: #f8f9fa;\n  display: flex;\n  flex-direction: column;\n}\n\n.detail-scroll {\n  flex: 1;\n  padding: 20rpx;\n  box-sizing: border-box;\n}\n\n.post-title {\n  font-size: 36rpx;\n  font-weight: bold;\n  margin-bottom: 20rpx;\n  color: #333;\n}\n\n.post-author {\n  display: flex;\n  align-items: center;\n  gap: 10rpx;\n  margin-bottom: 20rpx;\n  font-size: 28rpx;\n  color: #666;\n}\n\n.avatar {\n  width: 50rpx;\n  height: 50rpx;\n  border-radius: 50%;\n}\n\n.time {\n  margin-left: auto;\n}\n\n.post-desc {\n  background: white;\n  padding: 20rpx;\n  border-radius: 10rpx;\n  margin-bottom: 20rpx;\n  line-height: 1.6;\n  color: #555;\n}\n\n.media-container .media {\n  width: 100%;\n  border-radius: 10rpx;\n  margin-bottom: 20rpx;\n}\n\n.rating-section {\n  background: white;\n  padding: 20rpx;\n  border-radius: 10rpx;\n  margin-bottom: 30rpx;\n}\n.rating-header {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 20rpx;\n  font-weight: bold;\n}\n.rating-distribution .bar-row {\n  display: flex;\n  align-items: center;\n  gap: 10rpx;\n  margin-bottom: 10rpx;\n  font-size: 24rpx;\n}\n.rating-distribution progress {\n  flex: 1;\n  margin: 0 10rpx;\n}\n.my-rating {\n  margin-top: 10rpx;\n  color: #007aff;\n  font-weight: bold;\n}\n\n.comment-input-section {\n  background: white;\n  padding: 20rpx;\n  border-radius: 10rpx;\n  margin-bottom: 30rpx;\n}\n.comment-textarea {\n  width: 100%;\n  height: 120rpx;\n  padding: 10rpx;\n  border: 1rpx solid #ddd;\n  border-radius: 10rpx;\n  font-size: 28rpx;\n  margin-bottom: 20rpx;\n}\n.rating-input {\n  display: flex;\n  align-items: center;\n  gap: 10rpx;\n  margin-bottom: 20rpx;\n  font-size: 26rpx;\n}\n.star-radio {\n  display: flex;\n  align-items: center;\n  margin-right: 20rpx;\n}\n.submit-btn {\n  width: 100%;\n  background-color: #007aff;\n  color: white;\n  border-radius: 10rpx;\n  padding: 15rpx;\n  font-size: 28rpx;\n}\n\n.section-title {\n  font-weight: bold;\n  margin: 20rpx 0;\n  color: #333;\n}\n.comment-item {\n  background: white;\n  padding: 20rpx;\n  border-radius: 10rpx;\n  margin-bottom: 20rpx;\n}\n.comment-header {\n  display: flex;\n  align-items: center;\n  gap: 10rpx;\n  margin-bottom: 10rpx;\n}\n.comment-author {\n  font-weight: bold;\n}\n.comment-rating {\n  color: #FFD700;\n}\n.comment-time {\n  margin-left: auto;\n  font-size: 24rpx;\n  color: #999;\n}\n.comment-content {\n  line-height: 1.6;\n  color: #555;\n}\n.comment-actions {\n  margin-top: 10rpx;\n  text-align: right;\n}\n.comment-actions button {\n  padding: 5rpx 15rpx;\n  font-size: 24rpx;\n}\n\n.loading, .no-more, .empty {\n  text-align: center;\n  padding: 20rpx;\n  color: #999;\n}\n\n.delete-modal {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: white;\n  padding: 40rpx;\n  border-radius: 20rpx;\n  z-index: 1000;\n  text-align: center;\n}\n.delete-modal button {\n  margin-top: 20rpx;\n  padding: 10rpx 30rpx;\n  border-radius: 10rpx;\n  font-size: 28rpx;\n  width: 100%;\n}\n.delete-modal button:first-child {\n  background-color: #ff4d4d;\n  color: white;\n}\n.delete-modal button:last-child {\n  background-color: #eee;\n  margin-top: 10rpx;\n}\r\n.back-button {\n  position: fixed;\n  top: var(--status-bar-height); /* 避开状态栏 */\n  left: 20rpx;\n  z-index: 999;\n  width: 60rpx;\n  height: 60rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 36rpx;\n  color: #007aff;\n  background-color: rgba(255, 255, 255, 0.8);\n  border-radius: 50%;\n  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.1);\n}\n</style>","import MiniProgramPage from 'D:/软工大作业/小程序界面/pages/comtent/detail/detail.uvue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","__awaiter","uni","uniCloud","_a"],"mappings":"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"}